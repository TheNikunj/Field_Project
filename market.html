<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>College Items Marketplace</title>
    <style>
 * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    line-height: 1.6;
    background-color: #f5f5f5;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
}

header {
    background: linear-gradient(135deg, #4f46e5 0%, #3730a3 100%);
    color: white;
    padding: 1rem 0;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

header .container {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.header-buttons {
    display: flex;
    gap: 1rem;
}

.btn-primary {
    background-color: #4f46e5;
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 0.375rem;
    cursor: pointer;
    font-size: 1rem;
    transition: all 0.3s ease;
}

header .btn-primary {
    background-color: white;
    color: #4f46e5;
}

.btn-primary:hover {
    background-color: #4338ca;
    transform: translateY(-2px);
}

header .btn-primary:hover {
    background-color: #f8fafc;
    transform: translateY(-2px);
}

.btn-secondary {
    background-color: #e5e7eb;
    color: #374151;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 0.375rem;
    cursor: pointer;
    font-size: 1rem;
    transition: all 0.3s ease;
}

.btn-secondary:hover {
    background-color: #d1d5db;
    transform: translateY(-2px);
}

.search-container {
    margin: 2rem 0;
}

#searchInput {
    width: 100%;
    padding: 0.75rem 1rem;
    border: 1px solid #d1d5db;
    border-radius: 0.375rem;
    font-size: 1rem;
    transition: all 0.3s ease;
}

#searchInput:focus {
    outline: none;
    border-color: #4f46e5;
    box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
    transform: translateY(-1px);
}

.items-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1.5rem;
    padding: 1rem 0;
}

.item-card {
    background-color: white;
    border-radius: 1rem;
    overflow: hidden;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    transform-origin: center;
}

.item-card:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 0 12px 20px rgba(0, 0, 0, 0.15);
}

.item-image-container {
    position: relative;
    overflow: hidden;
    height: 200px;
}

.item-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.item-card:hover .item-image {
    transform: scale(1.1);
}

.item-price-tag {
    position: absolute;
    bottom: 0;
    right: 0;
    background: linear-gradient(135deg, #4f46e5 0%, #3730a3 100%);
    color: white;
    padding: 0.5rem 1rem;
    border-top-left-radius: 1rem;
    font-weight: bold;
    font-size: 1.125rem;
    box-shadow: -2px -2px 8px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
}

.item-card:hover .item-price-tag {
    padding: 0.75rem 1.25rem;
    background: linear-gradient(135deg, #3730a3 0%, #4f46e5 100%);
}

.item-content {
    padding: 1.5rem;
}

.item-title {
    font-size: 1.25rem;
    font-weight: 600;
    margin-bottom: 0.75rem;
    color: #1f2937;
}

.item-description {
    color: #6b7280;
    margin-bottom: 1.25rem;
    font-size: 0.95rem;
}

.whatsapp-btn {
    background-color: #25D366;
    color: white;
    border: none;
    padding: 0.75rem 1rem;
    border-radius: 0.75rem;
    cursor: pointer;
    width: 100%;
    font-size: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.whatsapp-btn:hover {
    background-color: #128C7E;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(37, 211, 102, 0.2);
}

.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(8px);
}

.modal.active {
    display: flex;
    animation: modalFadeIn 0.3s ease;
}

@keyframes modalFadeIn {
    from {
        opacity: 0;
        transform: translateY(-20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.modal-content {
    background-color: white;
    padding: 2rem;
    border-radius: 1rem;
    width: 100%;
    max-width: 500px;
    margin: 0 1rem;
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
}

.modal-content h2 {
    margin-bottom: 1.5rem;
    color: #1f2937;
    font-size: 1.5rem;
}

form {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

form input,
form textarea {
    padding: 0.75rem;
    border: 1px solid #d1d5db;
    border-radius: 0.75rem;
    font-size: 1rem;
    transition: all 0.3s ease;
}

form input:focus,
form textarea:focus {
    outline: none;
    border-color: #4f46e5;
    box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
    transform: translateY(-1px);
}

form textarea {
    min-height: 100px;
    resize: vertical;
}

.button-group {
    display: flex;
    gap: 1rem;
    margin-top: 1.5rem;
}

.button-group button {
    flex: 1;
    padding: 0.75rem;
    font-weight: 500;
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.file-input-container {
    position: relative;
    width: 100%;
}

#itemImage, #editItemImage {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid #d1d5db;
    border-radius: 0.75rem;
    font-size: 1rem;
    transition: all 0.3s ease;
}

.image-preview {
    width: 100%;
    height: 200px;
    margin-top: 0.5rem;
    border-radius: 0.75rem;
    background-color: #f3f4f6;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #6b7280;
}

.image-preview.has-image {
    border: 2px solid #4f46e5;
}

.admin-controls {
    position: absolute;
    top: 10px;
    right: 10px;
    display: flex;
    gap: 0.5rem;
    z-index: 10;
    background: rgba(255, 255, 255, 0.9);
    padding: 5px;
    border-radius: 20px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.item-card .admin-controls {
    opacity: 1;
    transform: scale(1);
}

.edit-btn, .delete-btn {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    border: none;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    transition: all 0.3s ease;
}

.edit-btn {
    background-color: #4f46e5;
}

.edit-btn:hover {
    background-color: #4338ca;
    transform: scale(1.1);
}

.delete-btn {
    background-color: #ef4444;
}

.delete-btn:hover {
    background-color: #dc2626;
    transform: scale(1.1);
}

.admin-mode-indicator {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: #4f46e5;
    color: white;
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 14px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    z-index: 1000;
    display: none;
}

.admin-mode-indicator.active {
    display: block;
    animation: slideIn 0.3s ease;
}

@keyframes slideIn {
    from {
        transform: translateY(20px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>College Items Marketplace</h1>
            <div class="header-buttons">
                <button id="adminLoginBtn" class="btn-secondary">Admin Login</button>
                <button id="addItemBtn" class="btn-primary">+ Sell Item</button>
            </div>
        </div>
    </header>

    <main class="container">
        <div class="search-container">
            <input type="text" id="searchInput" placeholder="Search college items...">
        </div>

        <div id="itemsContainer" class="items-grid"></div>
    </main>

    <!-- Add Item Modal -->
    <div id="addItemModal" class="modal">
        <div class="modal-content">
            <h2>Add New Item</h2>
            <form id="addItemForm">
                <input type="text" id="itemTitle" placeholder="Item Name" required>
                <input type="number" id="itemPrice" placeholder="Price in ₹" required>
                <textarea id="itemDescription" placeholder="Description (condition, features, etc.)" required></textarea>
                <div class="file-input-container">
                    <input type="file" id="itemImage" accept="image/*" required>
                    <div id="imagePreview" class="image-preview"></div>
                </div>
                <input type="tel" id="itemContact" placeholder="WhatsApp Number (with country code)" required>
                <div class="button-group">
                    <button type="submit" class="btn-primary">Add Item</button>
                    <button type="button" class="btn-secondary" id="closeModal">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div id="adminModal" class="modal">
        <div class="modal-content">
            <h2>Admin Login</h2>
            <form id="adminLoginForm">
                <input type="password" id="adminPassword" placeholder="Enter admin password" required>
                <div class="button-group">
                    <button type="submit" class="btn-primary">Login</button>
                    <button type="button" class="btn-secondary" id="closeAdminModal">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Item Modal -->
    <div id="editItemModal" class="modal">
        <div class="modal-content">
            <h2>Edit Item</h2>
            <form id="editItemForm">
                <input type="hidden" id="editItemId">
                <input type="text" id="editItemTitle" placeholder="Item Name" required>
                <input type="number" id="editItemPrice" placeholder="Price in ₹" required>
                <textarea id="editItemDescription" placeholder="Description (condition, features, etc.)" required></textarea>
                <div class="file-input-container">
                    <input type="file" id="editItemImage" accept="image/*">
                    <div id="editImagePreview" class="image-preview"></div>
                </div>
                <input type="tel" id="editItemContact" placeholder="WhatsApp Number (with country code)" required>
                <div class="button-group">
                    <button type="submit" class="btn-primary">Save Changes</button>
                    <button type="button" class="btn-secondary" id="closeEditModal">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <div id="adminModeIndicator" class="admin-mode-indicator">
        Admin Mode Active
    </div>

    <script>
        // Store items in localStorage
let defaultItems = [
    {
        id: 1,
        title: "Casio FX-991ES Plus Calculator",
        price: 899,
        description: "Scientific calculator in excellent condition. All functions working perfectly. Ideal for engineering students.",
        image: "https://images.unsplash.com/photo-1574607383476-f517f260d30b?auto=format&fit=crop&q=80&w=800",
        contact: "919876543210"
    },
    {
        id: 2,
        title: "Engineering Drawing Kit",
        price: 1499,
        description: "Complete drafter set including mini-drafter, set squares, scales, and compass. Used for one semester only.",
        image: "https://images.unsplash.com/photo-1581081686697-0f6e4eaef71f?auto=format&fit=crop&q=80&w=800",
        contact: "919876543211"
    },
    {
        id: 3,
        title: "Engineering Mathematics Textbook",
        price: 299,
        description: "Higher Engineering Mathematics by B.S. Grewal. Latest edition with all pages intact. No markings.",
        image: "https://images.unsplash.com/photo-1544716278-ca5e3f4abd8c?auto=format&fit=crop&q=80&w=800",
        contact: "919876543212"
    },
    {
        id: 4,
        title: "Premium College Backpack",
        price: 799,
        description: "American Tourister 32L laptop backpack. Water-resistant, multiple compartments. 1 year old but looks new.",
        image: "https://images.unsplash.com/photo-1553062407-98eeb64c6a62?auto=format&fit=crop&q=80&w=800",
        contact: "919876543213"
    }
];

// Initialize items from localStorage or use default items if empty
let items = JSON.parse(localStorage.getItem('marketplaceItems')) || defaultItems;
if (!localStorage.getItem('marketplaceItems')) {
    localStorage.setItem('marketplaceItems', JSON.stringify(items));
}

// Admin state
let isAdmin = false;
const ADMIN_PASSWORD = "admin123"; // In a real app, this should be properly secured

// DOM Elements
const addItemBtn = document.getElementById('addItemBtn');
const addItemModal = document.getElementById('addItemModal');
const closeModal = document.getElementById('closeModal');
const addItemForm = document.getElementById('addItemForm');
const searchInput = document.getElementById('searchInput');
const itemsContainer = document.getElementById('itemsContainer');
const imageInput = document.getElementById('itemImage');
const imagePreview = document.getElementById('imagePreview');
const adminLoginBtn = document.getElementById('adminLoginBtn');
const adminModal = document.getElementById('adminModal');
const adminLoginForm = document.getElementById('adminLoginForm');
const closeAdminModal = document.getElementById('closeAdminModal');
const editItemModal = document.getElementById('editItemModal');
const editItemForm = document.getElementById('editItemForm');
const closeEditModal = document.getElementById('closeEditModal');
const editItemImage = document.getElementById('editItemImage');
const editImagePreview = document.getElementById('editImagePreview');

// Handle image preview for add form
imageInput.addEventListener('change', function(e) {
    handleImagePreview(e, imagePreview);
});

// Handle image preview for edit form
editItemImage.addEventListener('change', function(e) {
    handleImagePreview(e, editImagePreview);
});

function handleImagePreview(e, previewElement) {
    const file = e.target.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            previewElement.style.backgroundImage = `url(${e.target.result})`;
            previewElement.classList.add('has-image');
        };
        reader.readAsDataURL(file);
    }
}

// Event Listeners
addItemBtn.addEventListener('click', () => {
    addItemModal.classList.add('active');
    imagePreview.style.backgroundImage = '';
    imagePreview.classList.remove('has-image');
});

closeModal.addEventListener('click', () => {
    addItemModal.classList.remove('active');
    addItemForm.reset();
    imagePreview.style.backgroundImage = '';
    imagePreview.classList.remove('has-image');
});

// Update the admin login button handler
adminLoginBtn.addEventListener('click', () => {
    if (isAdmin) {
        isAdmin = false;
        adminLoginBtn.textContent = 'Admin Login';
        document.getElementById('adminModeIndicator').classList.remove('active');
        renderItems(items);
    } else {
        adminModal.classList.add('active');
    }
});

closeAdminModal.addEventListener('click', () => {
    adminModal.classList.remove('active');
    adminLoginForm.reset();
});

closeEditModal.addEventListener('click', () => {
    editItemModal.classList.remove('active');
    editItemForm.reset();
    editImagePreview.style.backgroundImage = '';
    editImagePreview.classList.remove('has-image');
});

// Update the admin login handler
adminLoginForm.addEventListener('submit', (e) => {
    e.preventDefault();
    const password = document.getElementById('adminPassword').value;
    
    if (password === ADMIN_PASSWORD) {
        isAdmin = true;
        adminLoginBtn.textContent = 'Logout';
        adminModal.classList.remove('active');
        adminLoginForm.reset();
        document.getElementById('adminModeIndicator').classList.add('active');
        renderItems(items);
    } else {
        alert('Incorrect password');
    }
});

addItemForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const file = imageInput.files[0];
    if (!file) {
        alert('Please select an image');
        return;
    }

    // Convert image to base64
    const reader = new FileReader();
    reader.onload = function(e) {
        const newItem = {
            id: Date.now(),
            title: document.getElementById('itemTitle').value,
            price: parseFloat(document.getElementById('itemPrice').value),
            description: document.getElementById('itemDescription').value,
            image: e.target.result,
            contact: document.getElementById('itemContact').value
        };
        
        items.push(newItem);
        localStorage.setItem('marketplaceItems', JSON.stringify(items));
        
        addItemModal.classList.remove('active');
        addItemForm.reset();
        imagePreview.style.backgroundImage = '';
        imagePreview.classList.remove('has-image');
        renderItems(items);
    };
    
    reader.readAsDataURL(file);
});

editItemForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const itemId = parseInt(document.getElementById('editItemId').value);
    const file = editItemImage.files[0];
    
    const updateItem = () => {
        const itemIndex = items.findIndex(item => item.id === itemId);
        if (itemIndex !== -1) {
            items[itemIndex] = {
                ...items[itemIndex],
                title: document.getElementById('editItemTitle').value,
                price: parseFloat(document.getElementById('editItemPrice').value),
                description: document.getElementById('editItemDescription').value,
                contact: document.getElementById('editItemContact').value,
                ...(newImage && { image: newImage })
            };
            
            localStorage.setItem('marketplaceItems', JSON.stringify(items));
            editItemModal.classList.remove('active');
            editItemForm.reset();
            editImagePreview.style.backgroundImage = '';
            editImagePreview.classList.remove('has-image');
            renderItems(items);
        }
    };

    let newImage = null;
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            newImage = e.target.result;
            updateItem();
        };
        reader.readAsDataURL(file);
    } else {
        updateItem();
    }
});

searchInput.addEventListener('input', (e) => {
    const searchTerm = e.target.value.toLowerCase();
    const filteredItems = items.filter(item => 
        item.title.toLowerCase().includes(searchTerm) ||
        item.description.toLowerCase().includes(searchTerm)
    );
    renderItems(filteredItems);
});

// Format price in Indian Rupees
function formatPrice(price) {
    return new Intl.NumberFormat('en-IN', {
        style: 'currency',
        currency: 'INR',
        maximumFractionDigits: 0
    }).format(price);
}

// Delete item
function deleteItem(id) {
    if (!isAdmin) return;
    
    if (confirm('Are you sure you want to delete this item?')) {
        items = items.filter(item => item.id !== id);
        localStorage.setItem('marketplaceItems', JSON.stringify(items));
        renderItems(items);
    }
}

// Edit item
function editItem(id) {
    if (!isAdmin) return;
    
    const item = items.find(item => item.id === id);
    if (item) {
        document.getElementById('editItemId').value = item.id;
        document.getElementById('editItemTitle').value = item.title;
        document.getElementById('editItemPrice').value = item.price;
        document.getElementById('editItemDescription').value = item.description;
        document.getElementById('editItemContact').value = item.contact;
        editImagePreview.style.backgroundImage = `url(${item.image})`;
        editImagePreview.classList.add('has-image');
        editItemModal.classList.add('active');
    }
}

// Update the render function to make buttons more prominent
function renderItems(itemsToRender) {
    itemsContainer.innerHTML = itemsToRender.map(item => `
        <div class="item-card">
            ${isAdmin ? `
                <div class="admin-controls">
                    <button onclick="editItem(${item.id})" class="edit-btn" title="Edit item">✎</button>
                    <button onclick="deleteItem(${item.id})" class="delete-btn" title="Delete item">×</button>
                </div>
            ` : ''}
            <div class="item-image-container">
                <img src="${item.image}" alt="${item.title}" class="item-image">
                <div class="item-price-tag">${formatPrice(item.price)}</div>
            </div>
            <div class="item-content">
                <h3 class="item-title">${item.title}</h3>
                <p class="item-description">${item.description}</p>
                <button onclick="openWhatsApp('${item.contact}')" class="whatsapp-btn">
                    Chat on WhatsApp
                </button>
            </div>
        </div>
    `).join('');
}

// Open WhatsApp chat
function openWhatsApp(contact) {
    window.open(`https://wa.me/${contact}`, '_blank');
}

// Initial render
renderItems(items);
    </script>
</body>
</html>